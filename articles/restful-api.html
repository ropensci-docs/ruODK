<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Accessing submission data via the REST pathway.
">
<title>Accessing the RESTful API • ruODK</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Accessing the RESTful API">
<meta property="og:description" content="Accessing submission data via the REST pathway.
">
<meta property="og:image" content="https://docs.ropensci.org/ruODK/reference/figures/ruODK2.png">
<meta property="og:image:alt" content="An R Client for the ODK Central API">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@florianm">
<meta name="twitter:site" content="@rOpenSci">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">ruODK</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/comparison.html">Comparison of related software packages</a>
    <a class="dropdown-item" href="../articles/odata-api.html">Accessing the OData API</a>
    <a class="dropdown-item" href="../articles/restful-api.html">Accessing the RESTful API</a>
    <a class="dropdown-item" href="../articles/setup.html">Setup</a>
    <a class="dropdown-item" href="../articles/spatial.html">Spatial data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/ruODK/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="restful-api_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="restful-api_files/jsoneditor-0.18.7/jsoneditor.min.js"></script><script src="restful-api_files/jsonedit-binding-4.0.0/jsonedit.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Accessing the RESTful API</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/ruODK/blob/HEAD/vignettes/restful-api.Rmd" class="external-link"><code>vignettes/restful-api.Rmd</code></a></small>
      <div class="d-none name"><code>restful-api.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>This vignette provides a guided walk-through of the “getting data out” functions of the RESTful API endpoints which list and view details.</p>
<p><code>ruODK</code> users would mix and match parts of the demonstrated workflows to build their own data pipelines, e.g.:</p>
<ul>
<li>to build a quick analysis from all data, freshly downloaded from a smaller project, or</li>
<li>to build an interactive ETL pipeline to selectively download only new submissions for further processing and upload into downstream data warehouses.</li>
</ul>
<p>A typical and more stream-lined workflow is provided in the RMarkdown template “ODK Central via OData” which is supplied by <code>ruODK</code>.</p>
<div class="section level3">
<h3 id="three-ways-to-happiness">Three ways to happiness<a class="anchor" aria-label="anchor" href="#three-ways-to-happiness"></a>
</h3>
<p>ODK Central offers no less than three different ways to access data:</p>
<ul>
<li>viewing ODK Central data in MS PowerBI, MS Excel, Tableau, or <code>ruODK</code> through the OData service endpoints, or</li>
<li>downloading all submissions including attachments as one (possibly gigantic) zip archive either through the “Export Submissions” button in the ODK Central form submissions page or through <code>ruODK</code>, or</li>
<li>viewing ODK Central data through <code>ruODK</code>’s RESTful API functions.</li>
</ul>
<p>While the <code>vignette("odata", package="ruODK")</code> (online <a href="https://docs.ropensci.org/ruODK/articles/odata-api.html">here</a>) illustrates the first option, this vignette demonstrates the remaining two.</p>
<p>Not implemented (yet) are the “managing ODK Central” functions which create, update, and delete projects, forms, users, roles, and permissions. We haven’t yet found a strong use case to automate those functions - ODK Central (driven by humans) does those jobs beautifully on an expected scale.</p>
</div>
</div>
<div class="section level2">
<h2 id="setup-ruodk">Setup ruODK<a class="anchor" aria-label="anchor" href="#setup-ruodk"></a>
</h2>
<p>See <a href="https://docs.ropensci.org/ruODK/articles/setup.html"><code>vignette("Setup", package = "ruODK")</code></a> for detailed options to configure <code>ruODK</code>.</p>
<p>Here, we’ll grab the OData service URL from the form used in this vignette, plus username and password of a web user of ODK Central with access to that form.</p>
<p><code><a href="../reference/ru_setup.html">ruODK::ru_setup()</a></code> will populate the default url, project ID, and form ID which are used by <code>ruODK</code>’s other functions (unless specified otherwise).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/ruODK">ruODK</a></span><span class="op">)</span></span>
<span><span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/ru_setup.html">ru_setup</a></span><span class="op">(</span></span>
<span>  svc <span class="op">=</span> <span class="st">"https://sandbox.central.getodk.org/v1/projects/14/forms/build_Flora-Quadrat-0-4_1564384341.svc"</span>,</span>
<span>  un <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"ODKC_TEST_UN"</span><span class="op">)</span>,</span>
<span>  pw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"ODKC_TEST_PW"</span><span class="op">)</span>,</span>
<span>  tz <span class="op">=</span> <span class="st">"Australia/Perth"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;ruODK settings&gt;</span></span>
<span><span class="co">#&gt;   Default ODK Central Project ID: 14 </span></span>
<span><span class="co">#&gt;   Default ODK Central Form ID: build_Flora-Quadrat-0-4_1564384341 </span></span>
<span><span class="co">#&gt;   Default ODK Central URL: https://sandbox.central.getodk.org </span></span>
<span><span class="co">#&gt;   Default ODK Central Username: me@email.com </span></span>
<span><span class="co">#&gt;   Default ODK Central Password: run ruODK::get_default_pw() to show </span></span>
<span><span class="co">#&gt;   Default ODK Central Passphrase: run ruODK::get_default_pp() to show </span></span>
<span><span class="co">#&gt;   Default Time Zone: Australia/Perth </span></span>
<span><span class="co">#&gt;   Default ODK Central Version: 2023.4.0 </span></span>
<span><span class="co">#&gt;   Default HTTP GET retries: 3 </span></span>
<span><span class="co">#&gt;   Verbose messages: TRUE </span></span>
<span><span class="co">#&gt;   Test ODK Central Project ID: 14 </span></span>
<span><span class="co">#&gt;   Test ODK Central Form ID: build_Flora-Quadrat-0-2_1558575936 </span></span>
<span><span class="co">#&gt;   Test ODK Central Form ID (ZIP tests): build_Spotlighting-0-6_1558333698 </span></span>
<span><span class="co">#&gt;   Test ODK Central Form ID (Attachment tests): build_Flora-Quadrat-0-1_1558330379 </span></span>
<span><span class="co">#&gt;   Test ODK Central Form ID (Parsing tests): build_Turtle-Track-or-Nest-1-0_1569907666 </span></span>
<span><span class="co">#&gt;   Test ODK Central Form ID (WKT tests): build_Locations_1589344221 </span></span>
<span><span class="co">#&gt;   Test ODK Central URL: https://sandbox.central.getodk.org </span></span>
<span><span class="co">#&gt;   Test ODK Central Username: me@email.com </span></span>
<span><span class="co">#&gt;   Test ODK Central Password: run ruODK::get_test_pw() to show </span></span>
<span><span class="co">#&gt;   Test ODK Central Passphrase: run ruODK::get_test_pp() to show </span></span>
<span><span class="co">#&gt;   Test ODK Central Version: 2023.4.0</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html" class="external-link">dir_create</a></span><span class="op">(</span><span class="st">"media"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="projects">Projects<a class="anchor" aria-label="anchor" href="#projects"></a>
</h2>
<p>List projects. We see the project ID, a name, the number of forms and app users, dates of last form submissions plus project management timestamps (created, updated).</p>
<p>The important bit here is the project ID.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_project_list</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/project_list.html">project_list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_project_list</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="0%">
<col width="2%">
<col width="3%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="84%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="0%">
</colgroup>
<thead><tr class="header">
<th align="right">id</th>
<th align="left">name</th>
<th align="left">description</th>
<th align="left">archived</th>
<th align="right">key_id</th>
<th align="left">created_at</th>
<th align="left">updated_at</th>
<th align="left">deleted_at</th>
<th align="left">verbs</th>
<th align="right">forms</th>
<th align="right">app_users</th>
<th align="right">datasets</th>
<th align="left">last_submission</th>
<th align="left">last_entity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">ruODK package tests</td>
<td align="left">Forms and submissions used for <a href="https://github.com/ropensci/ruODK/" class="external-link">ruODK</a> package tests.</td>
<td align="left">FALSE</td>
<td align="right">NA</td>
<td align="left">2023-08-04T01:47:13.622Z</td>
<td align="left">2023-12-03T07:21:07.280Z</td>
<td align="left">NA</td>
<td align="left">analytics.read , assignment.create , assignment.delete , assignment.list , audit.read , backup.run , config.read , config.set , dataset.list , dataset.read , dataset.update , entity.create , entity.list , entity.read , entity.update , field_key.create , field_key.delete , field_key.list , form.create , form.delete , form.list , form.read , form.restore , form.update , project.create , project.delete , project.read , project.update , public_link.create , public_link.delete , public_link.list , public_link.read , public_link.update , role.create , role.delete , role.update , session.end , submission.create , submission.list , submission.read , submission.update , user.create , user.delete , user.list , user.password.invalidate, user.read , user.update</td>
<td align="right">13</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="left">2024-03-04T07:08:52.813Z</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">ruODK package tests encrypted</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="left">2023-08-04T01:47:41.258Z</td>
<td align="left">2024-03-04T07:04:18.715Z</td>
<td align="left">NA</td>
<td align="left">analytics.read , assignment.create , assignment.delete , assignment.list , audit.read , backup.run , config.read , config.set , dataset.list , dataset.read , dataset.update , entity.create , entity.list , entity.read , entity.update , field_key.create , field_key.delete , field_key.list , form.create , form.delete , form.list , form.read , form.restore , form.update , project.create , project.delete , project.read , project.update , public_link.create , public_link.delete , public_link.list , public_link.read , public_link.update , role.create , role.delete , role.update , session.end , submission.create , submission.list , submission.read , submission.update , user.create , user.delete , user.list , user.password.invalidate, user.read , user.update</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">2024-03-04T07:06:16.788Z</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">Sandbox</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
<td align="right">NA</td>
<td align="left">2023-08-04T01:47:50.572Z</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">analytics.read , assignment.create , assignment.delete , assignment.list , audit.read , backup.run , config.read , config.set , dataset.list , dataset.read , dataset.update , entity.create , entity.list , entity.read , entity.update , field_key.create , field_key.delete , field_key.list , form.create , form.delete , form.list , form.read , form.restore , form.update , project.create , project.delete , project.read , project.update , public_link.create , public_link.delete , public_link.list , public_link.read , public_link.update , role.create , role.delete , role.update , session.end , submission.create , submission.list , submission.read , submission.update , user.create , user.delete , user.list , user.password.invalidate, user.read , user.update</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p>Inspect a project using its ID. We receive a tibble with exactly one row, all the columns of <code><a href="../reference/project_list.html">ruODK::project_list</a></code> plus a column <code>verbs</code>, which contains all available API actions for a project.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_project_detail</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/project_detail.html">project_detail</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Project details (without verbs)</span></span>
<span><span class="va">fq_project_detail</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="st">"verbs"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="2%">
<col width="16%">
<col width="4%">
<col width="8%">
<col width="20%">
<col width="20%">
<col width="20%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="right">id</th>
<th align="left">name</th>
<th align="right">forms</th>
<th align="right">app_users</th>
<th align="left">last_submission</th>
<th align="left">created_at</th>
<th align="left">updated_at</th>
<th align="left">archived</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">1</td>
<td align="left">ruODK package tests</td>
<td align="right">13</td>
<td align="right">2</td>
<td align="left">2024-03-04T07:08:52.813Z</td>
<td align="left">2023-08-04T01:47:13.622Z</td>
<td align="left">2023-12-03T07:21:07.280Z</td>
<td align="left">FALSE</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Available verbs</span></span>
<span><span class="va">fq_project_detail</span><span class="op">$</span><span class="va">verbs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "config.read"              "field_key.create"        </span></span>
<span><span class="co">#&gt;  [3] "field_key.delete"         "field_key.list"          </span></span>
<span><span class="co">#&gt;  [5] "form.create"              "form.delete"             </span></span>
<span><span class="co">#&gt;  [7] "form.list"                "form.read"               </span></span>
<span><span class="co">#&gt;  [9] "form.update"              "project.create"          </span></span>
<span><span class="co">#&gt; [11] "project.delete"           "project.read"            </span></span>
<span><span class="co">#&gt; [13] "project.update"           "session.end"             </span></span>
<span><span class="co">#&gt; [15] "submission.create"        "submission.read"         </span></span>
<span><span class="co">#&gt; [17] "submission.list"          "user.create"             </span></span>
<span><span class="co">#&gt; [19] "user.list"                "user.password.invalidate"</span></span>
<span><span class="co">#&gt; [21] "user.read"                "user.update"             </span></span>
<span><span class="co">#&gt; [23] "submission.update"        "role.create"             </span></span>
<span><span class="co">#&gt; [25] "role.update"              "role.delete"             </span></span>
<span><span class="co">#&gt; [27] "assignment.list"          "assignment.create"       </span></span>
<span><span class="co">#&gt; [29] "assignment.delete"        "user.delete"             </span></span>
<span><span class="co">#&gt; [31] "audit.read"               "public_link.create"      </span></span>
<span><span class="co">#&gt; [33] "public_link.list"         "public_link.read"        </span></span>
<span><span class="co">#&gt; [35] "public_link.update"       "public_link.delete"      </span></span>
<span><span class="co">#&gt; [37] "backup.run"               "config.set"              </span></span>
<span><span class="co">#&gt; [39] "analytics.read"           "form.restore"            </span></span>
<span><span class="co">#&gt; [41] "dataset.list"             "entity.list"             </span></span>
<span><span class="co">#&gt; [43] "dataset.read"             "entity.read"             </span></span>
<span><span class="co">#&gt; [45] "entity.create"            "entity.update"           </span></span>
<span><span class="co">#&gt; [47] "dataset.update"</span></span></code></pre></div>
<p>Nothing apart from the verbs is new compared to the data returned by <code><a href="../reference/project_list.html">ruODK::project_list</a></code>.</p>
<p>To learn more about the functionality behind the verbs, refer to the interactive <a href="https://docs.getodk.org/central-api/" class="external-link">ODK Central API documentation</a>.</p>
<p>To retrieve data from ODK Central, the functions shown below will suffice.</p>
</div>
<div class="section level2">
<h2 id="forms">Forms<a class="anchor" aria-label="anchor" href="#forms"></a>
</h2>
<div class="section level3">
<h3 id="list-forms-for-a-project">List forms for a project<a class="anchor" aria-label="anchor" href="#list-forms-for-a-project"></a>
</h3>
<p>To download form submissions, we need to know project ID and form ID.</p>
<p>There are several ways of retrieving the form ID:</p>
<ul>
<li>Browsing forms in the ODK Central’s project overviews,</li>
<li>Stealing the form ID from the OData service endpoint URL as shown on ODK Central’s form submission page,</li>
<li>Listing form metadata for a given project ID with <code><a href="../reference/form_list.html">ruODK::form_list()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_form_list</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/form_list.html">form_list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_form_list</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="1%">
<col width="3%">
<col width="0%">
<col width="4%">
<col width="8%">
<col width="2%">
<col width="2%">
<col width="0%">
<col width="1%">
<col width="4%">
<col width="5%">
<col width="8%">
<col width="8%">
<col width="2%">
<col width="4%">
<col width="1%">
<col width="1%">
<col width="2%">
<col width="3%">
<col width="2%">
<col width="3%">
<col width="8%">
<col width="1%">
<col width="2%">
<col width="3%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="3%">
</colgroup>
<thead><tr class="header">
<th align="right">project_id</th>
<th align="left">xml_form_id</th>
<th align="left">state</th>
<th align="left">enketo_id</th>
<th align="left">enketo_once_id</th>
<th align="left">created_at</th>
<th align="left">updated_at</th>
<th align="left">key_id</th>
<th align="left">version</th>
<th align="left">hash</th>
<th align="left">sha</th>
<th align="left">sha256</th>
<th align="left">draft_token</th>
<th align="left">published_at</th>
<th align="left">name</th>
<th align="right">submissions</th>
<th align="left">entity_related</th>
<th align="right">review_states_received</th>
<th align="right">review_states_has_issues</th>
<th align="right">review_states_edited</th>
<th align="left">last_submission</th>
<th align="left">excel_content_type</th>
<th align="right">created_by_id</th>
<th align="left">created_by_type</th>
<th align="left">created_by_display_name</th>
<th align="left">created_by_created_at</th>
<th align="left">created_by_updated_at</th>
<th align="left">created_by_deleted_at</th>
<th align="left">fid</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">burn_grading_forest</td>
<td align="left">open</td>
<td align="left">WKA7p8XRttHcS89tVdwuIFHNlAWJHfS</td>
<td align="left">04f0c916ad25ac1aeaa33316520f7aae2099bbdbd862bd77b1845b1f807e2a26</td>
<td align="left">2023-08-09 11:14:17</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left">2023.1.1</td>
<td align="left">5be80a0e66f1238ec7ac9a21237a8867</td>
<td align="left">c063c0f32f92f4020fcebee694cdde8baf91dfc6</td>
<td align="left">1e6ed61493b88328a7458d720d87688ccd6034e7601986fe3ccdb1c06ec72e50</td>
<td align="left">NA</td>
<td align="left">2023-08-09 11:26:31</td>
<td align="left">Burn Grading Forest</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2023-08-09T05:09:55.750Z</td>
<td align="left">application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">burn_grading_forest</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">burn_grading_heath</td>
<td align="left">open</td>
<td align="left">7WX4lTXqmeet7CHz8jjwLOc0EEmISkl</td>
<td align="left">2123c75dd4250401fcfee5abb7ddd24ba92cb5c00d84bcda1304a3454df0ba74</td>
<td align="left">2023-08-09 11:17:02</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left">2023.1.0</td>
<td align="left">4f9a8b2d9b3eb1243f158d92567df956</td>
<td align="left">ee591e640b97b2114a83ae20d90c40f3982f3091</td>
<td align="left">8939811d509f09989be67d6b9e2988cc80ffff44b31727e269cce05d71699b23</td>
<td align="left">NA</td>
<td align="left">2023-08-09 11:23:56</td>
<td align="left">Burn Grading Heath</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2023-08-09T05:13:06.566Z</td>
<td align="left">application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">burn_grading_heath</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">burn_grading_verify</td>
<td align="left">open</td>
<td align="left">iQyzGfu0OspiuOMTlzM4HCbqkLWQRx8</td>
<td align="left">20acaacf05e7275ef74ba9ef52d14743c6754c03bc090a2cbf5aace293987a55</td>
<td align="left">2023-08-09 11:50:37</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left">2023.1.3</td>
<td align="left">f3879cdd1087ea3d950dabb3bd91d96f</td>
<td align="left">b6c0d1ba1043de79fac80d92f563c403e94adffc</td>
<td align="left">18d3e9210590979a7bfbe34f528410432683cec1b59618fcd69c8f0b50575410</td>
<td align="left">NA</td>
<td align="left">2023-08-09 15:34:50</td>
<td align="left">Burn Grading Verify</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2023-08-09T05:14:09.891Z</td>
<td align="left">application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">burn_grading_verify</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Flora-Quadrat-04</td>
<td align="left">open</td>
<td align="left">t2fdSUXiyPboismgJValMrie7hal5YF</td>
<td align="left">2609a277d7f47e53c69424514de96ca298d25586e49c990b299cbc189478e7ec</td>
<td align="left">2023-12-03 15:02:20</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left"></td>
<td align="left">434ff9e1e33fc8bb35148c0cc6979708</td>
<td align="left">206cf55b28adcd82db91bc5c11012524654c5bd1</td>
<td align="left">bb3b86a93ab3f6f5a16a6daa693c19a0c04f3deb68e50cf1bacd7c37efd9024a</td>
<td align="left">NA</td>
<td align="left">2023-12-03 15:02:27</td>
<td align="left">Flora Quadrat 0.4</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2023-12-04T08:30:26.154Z</td>
<td align="left">NA</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">Flora-Quadrat-04</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Flora-Quadrat-04-gap</td>
<td align="left">open</td>
<td align="left">7UzBNe95jXhdfqqG2JTmEG7mhQHoKQ1</td>
<td align="left">040a5a743b5c1f8e78d4021df766b7228a5f481fbf7a959944d52d36299fde2b</td>
<td align="left">2023-12-03 15:09:55</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left"></td>
<td align="left">241c4759564ea039b4404b6892025500</td>
<td align="left">61f5d1694e8866f6468ba6a2ff1c286226a66898</td>
<td align="left">9504ab3daa2bf99270a7d4046c636a15c1972cdd93df388e936ad78411d619d9</td>
<td align="left">NA</td>
<td align="left">2023-12-03 15:10:05</td>
<td align="left">Flora Quadrat 0.4 (gap)</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2024-03-04T07:08:52.813Z</td>
<td align="left">NA</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">Flora-Quadrat-04-gap</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Flora-Quadrat-04-att</td>
<td align="left">open</td>
<td align="left">0cuZcMAa1kemse3CFaws0ePH7hR0UPj</td>
<td align="left">abf4f5edfb84342553f98177367167669c77b0155dd951ee4ddcb62e35cb917d</td>
<td align="left">2023-12-03 15:09:43</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left"></td>
<td align="left">2cb6a4b3d7f05ab055f3da89d0958b14</td>
<td align="left">c130067ce8f7940acf807e74a433fa2ec3545995</td>
<td align="left">7b251e39369d48401ff4205ea0faf6b7bd1e04e5b8acb9f7b638b51459a22b94</td>
<td align="left">NA</td>
<td align="left">2023-12-03 15:09:46</td>
<td align="left">Flora Quadrat 0.4 (one att)</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2023-12-03T07:45:07.801Z</td>
<td align="left">NA</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">Flora-Quadrat-04-att</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">I8n_label_choices</td>
<td align="left">open</td>
<td align="left">bRT4lNCag0T0ASSJKJ8pHjNTCTFTO4s</td>
<td align="left">dbc21554352efe46948676b230b7c1abf8c5b1fcb25106109ae9dd6288b82fb5</td>
<td align="left">2023-12-03 15:03:14</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left"></td>
<td align="left">14e3449067ec33efd82067a546c6554d</td>
<td align="left">e190b678274da24e1ceb66f1de6d842550c29a5f</td>
<td align="left">4a7185f3ef411eb8749dbd9b540b811fffdec0572639425f0f7920ac9e9d09d9</td>
<td align="left">NA</td>
<td align="left">2023-12-03 15:03:18</td>
<td align="left">I8n label and choices</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2023-12-04T08:30:56.757Z</td>
<td align="left">NA</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">I8n_label_choices</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">I8n_label_lng</td>
<td align="left">open</td>
<td align="left">9sPuYNXpeZMnU7heWvoowMztz5Y93gH</td>
<td align="left">721e3c286e1b279a8885e3a443eb41335fdf310eed95b69a3424167e0c6ab8a5</td>
<td align="left">2023-12-03 15:03:31</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left"></td>
<td align="left">6932ca6e75078cae86b9eaec119abad0</td>
<td align="left">60e1ef208de91be00138f2c911da09dabb34e366</td>
<td align="left">c57f1a1d5f5f44fc119ceaa1c4db684f8159b3d9783a540e40dce3654299da19</td>
<td align="left">NA</td>
<td align="left">2023-12-03 15:03:51</td>
<td align="left">I8n label lang</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2023-12-04T08:31:29.169Z</td>
<td align="left">NA</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">I8n_label_lng</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">I8n_lang_choicefilter</td>
<td align="left">open</td>
<td align="left">orpw5UXdq6Jym3aQg7IPwFnw4oRWYNL</td>
<td align="left">3072a8269c47b18ab49baa79bff29976e7700c0603daf5c2d99590dda62d63af</td>
<td align="left">2023-12-03 15:06:32</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left"></td>
<td align="left">02cc779cbc7ff0a136de77b7f7b8135d</td>
<td align="left">fee1eb0b77aa5442885e231d4126f32aeb202040</td>
<td align="left">d842d8e9deb83bbf3475ef5e157286ca311f6cdf2cafebee04638d860489e39d</td>
<td align="left">NA</td>
<td align="left">2023-12-03 15:06:36</td>
<td align="left">I8n label lang with choice filter</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2023-12-04T08:32:30.641Z</td>
<td align="left">application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">I8n_lang_choicefilter</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">I8n_no_lang_choicefilter</td>
<td align="left">open</td>
<td align="left">mByFnZbERATLDRmmksDYBqD1Rqz8Eab</td>
<td align="left">1f73b6265b220ed01499c97b0e21eed07ed30bffa7a206b54700887aeacb669f</td>
<td align="left">2023-12-03 15:09:17</td>
<td align="left">2023-12-03 15:19:38</td>
<td align="left">NA</td>
<td align="left"></td>
<td align="left">fc5d8a6c19662445b890a1165bde6810</td>
<td align="left">a58e58f13df3a56dfbc538b5210fa3f3cfe39bbe</td>
<td align="left">0e647b8099d3bb84aa548b24a23b2b7f0383ff6a350bdeebf7adbeb8de61bfe7</td>
<td align="left">NA</td>
<td align="left">2023-12-03 15:19:38</td>
<td align="left">I8n label no lang with choice filter</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2023-12-04T08:35:23.748Z</td>
<td align="left">application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">I8n_no_lang_choicefilter</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Locations</td>
<td align="left">open</td>
<td align="left">NT1E6p5HlknfdSW2VttaKgjb8DctRqy</td>
<td align="left">bdf9c1c0dc5f1a607ae7d10ac4a4182c996030a2ac286b45c317cad6b23d8acd</td>
<td align="left">2023-12-03 15:02:45</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left"></td>
<td align="left">7365cf1fdad8d6c0ae7351bc05ecc2f2</td>
<td align="left">784e30dc8daeb89b2b5680723cf520314843cba4</td>
<td align="left">d368f86c1e33b5682e10d7b9d7753e7edf6a35086bf6688945a281996cd30094</td>
<td align="left">NA</td>
<td align="left">2023-12-03 15:02:48</td>
<td align="left">Locations</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2023-12-04T08:38:52.712Z</td>
<td align="left">NA</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">Locations</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Locations_draft</td>
<td align="left">open</td>
<td align="left">itxB8ymLuT8YNq7Dx6tO5GUUpNCwq4H</td>
<td align="left">NA</td>
<td align="left">2023-12-03 15:10:14</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left"></td>
<td align="left">d1701aad460c192c2fc97eb10241e350</td>
<td align="left">d7726b5ecf5311e65730e0aa51afa61b93284ce8</td>
<td align="left">3c26873d0450f32f5dac86f6a52f5248a2eb97800e78d98adb4c7a2f2d8334bc</td>
<td align="left">itexle5sIMlJkDlfzz3yW8pw2gJ4dwdWbT8F8utpK$g5hA7klBPyiuuoxw4zddqN</td>
<td align="left">NA</td>
<td align="left">Locations (draft)</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">Locations_draft</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Locations_no_submissions</td>
<td align="left">open</td>
<td align="left">LWKvSaSk7Qa2FHFmNVf4AAuxqSH9zss</td>
<td align="left">74e225cac7e93d106d30c319d7ed72c0187651526c7756c54baf5ff7376ca116</td>
<td align="left">2023-12-03 15:10:32</td>
<td align="left">2023-12-03 15:19:34</td>
<td align="left">NA</td>
<td align="left"></td>
<td align="left">eb7caf4e3994b953999165ddfdb6eb3b</td>
<td align="left">ae23fca247232b723073e5d842944172c77bd110</td>
<td align="left">21e7b36f8fca61aae069e4ce7483549a97b915453a37f1436cd32882d23eeb3b</td>
<td align="left">NA</td>
<td align="left">2023-12-03 15:10:35</td>
<td align="left">Locations (no submissions)</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">6</td>
<td align="left">user</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-06-30 04:23:51</td>
<td align="left">2023-08-10 09:41:29</td>
<td align="left">NA</td>
<td align="left">Locations_no_submissions</td>
</tr>
</tbody>
</table>
<p>Further to the metadata shown here, a column <code>xml</code> contains the entire XForms definition (originally XML) as nested list.</p>
<p>If the original XML is needed rather than the R equivalent (nested list), we can use <code><a href="../reference/form_xml.html">ruODK::form_xml</a></code> with parameter <code>parse=FALSE</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_form_xml</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/form_xml.html">form_xml</a></span><span class="op">(</span>parse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/timelyportfolio/listviewer" class="external-link">listviewer</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">listviewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/listviewer/man/jsonedit.html" class="external-link">jsonedit</a></span><span class="op">(</span><span class="va">fq_form_xml</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ru_msg_warn.html">ru_msg_warn</a></span><span class="op">(</span><span class="st">"Install package listviewer to browse the form XML."</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required package: listviewer</span></span></code></pre></div>
<div class="jsonedit html-widget html-fill-item" id="htmlwidget-15b494abcd3a31764488" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-15b494abcd3a31764488">{"x":{"data":{"node":{},"doc":{}},"options":{"mode":"tree","modes":["text","tree","table"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="inspect-form-schema">Inspect form schema<a class="anchor" aria-label="anchor" href="#inspect-form-schema"></a>
</h3>
<p>The <code>form_schema</code> represents all form fields of the XForms definition.</p>
<p>See the <a href="https://docs.getodk.org/central-api-form-management/#getting-form-schema-fields" class="external-link">ODK Central API docs</a> and the examples of <code>??ruODK::form_schema()</code> for more detail.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_form_schema</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/form_schema.html">form_schema</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_form_schema</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="31%">
<col width="19%">
<col width="5%">
<col width="4%">
<col width="8%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th align="left">path</th>
<th align="left">name</th>
<th align="left">type</th>
<th align="left">binary</th>
<th align="left">selectMultiple</th>
<th align="left">ruodk_name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">/meta</td>
<td align="left">meta</td>
<td align="left">structure</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">meta</td>
</tr>
<tr class="even">
<td align="left">/meta/instanceID</td>
<td align="left">instanceID</td>
<td align="left">string</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">meta_instance_id</td>
</tr>
<tr class="odd">
<td align="left">/encounter_start_datetime</td>
<td align="left">encounter_start_datetime</td>
<td align="left">dateTime</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">encounter_start_datetime</td>
</tr>
<tr class="even">
<td align="left">/reporter</td>
<td align="left">reporter</td>
<td align="left">string</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">reporter</td>
</tr>
<tr class="odd">
<td align="left">/device_id</td>
<td align="left">device_id</td>
<td align="left">string</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">device_id</td>
</tr>
<tr class="even">
<td align="left">/location</td>
<td align="left">location</td>
<td align="left">structure</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">location</td>
</tr>
<tr class="odd">
<td align="left">/location/area_name</td>
<td align="left">area_name</td>
<td align="left">string</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">location_area_name</td>
</tr>
<tr class="even">
<td align="left">/location/quadrat_photo</td>
<td align="left">quadrat_photo</td>
<td align="left">binary</td>
<td align="left">TRUE</td>
<td align="left">NA</td>
<td align="left">location_quadrat_photo</td>
</tr>
<tr class="odd">
<td align="left">/location/corner1</td>
<td align="left">corner1</td>
<td align="left">geopoint</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">location_corner1</td>
</tr>
<tr class="even">
<td align="left">/habitat</td>
<td align="left">habitat</td>
<td align="left">structure</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">habitat</td>
</tr>
<tr class="odd">
<td align="left">/habitat/morphological_type</td>
<td align="left">morphological_type</td>
<td align="left">select1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">habitat_morphological_type</td>
</tr>
<tr class="even">
<td align="left">/habitat/morphological_type_photo</td>
<td align="left">morphological_type_photo</td>
<td align="left">binary</td>
<td align="left">TRUE</td>
<td align="left">NA</td>
<td align="left">habitat_morphological_type_photo</td>
</tr>
<tr class="odd">
<td align="left">/vegetation_stratum</td>
<td align="left">vegetation_stratum</td>
<td align="left">repeat</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">vegetation_stratum</td>
</tr>
<tr class="even">
<td align="left">/vegetation_stratum/nvis_level3_broad_floristic_group</td>
<td align="left">nvis_level3_broad_floristic_group</td>
<td align="left">select1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">vegetation_stratum_nvis_level3_broad_floristic_group</td>
</tr>
<tr class="odd">
<td align="left">/vegetation_stratum/max_height_m</td>
<td align="left">max_height_m</td>
<td align="left">decimal</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">vegetation_stratum_max_height_m</td>
</tr>
<tr class="even">
<td align="left">/vegetation_stratum/foliage_cover</td>
<td align="left">foliage_cover</td>
<td align="left">select1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">vegetation_stratum_foliage_cover</td>
</tr>
<tr class="odd">
<td align="left">/vegetation_stratum/dominant_species_1</td>
<td align="left">dominant_species_1</td>
<td align="left">string</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">vegetation_stratum_dominant_species_1</td>
</tr>
<tr class="even">
<td align="left">/vegetation_stratum/dominant_species_2</td>
<td align="left">dominant_species_2</td>
<td align="left">string</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">vegetation_stratum_dominant_species_2</td>
</tr>
<tr class="odd">
<td align="left">/vegetation_stratum/dominant_species_3</td>
<td align="left">dominant_species_3</td>
<td align="left">string</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">vegetation_stratum_dominant_species_3</td>
</tr>
<tr class="even">
<td align="left">/vegetation_stratum/dominant_species_4</td>
<td align="left">dominant_species_4</td>
<td align="left">string</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">vegetation_stratum_dominant_species_4</td>
</tr>
<tr class="odd">
<td align="left">/perimeter</td>
<td align="left">perimeter</td>
<td align="left">structure</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">perimeter</td>
</tr>
<tr class="even">
<td align="left">/perimeter/corner2</td>
<td align="left">corner2</td>
<td align="left">geopoint</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">perimeter_corner2</td>
</tr>
<tr class="odd">
<td align="left">/perimeter/corner3</td>
<td align="left">corner3</td>
<td align="left">geopoint</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">perimeter_corner3</td>
</tr>
<tr class="even">
<td align="left">/perimeter/corner4</td>
<td align="left">corner4</td>
<td align="left">geopoint</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">perimeter_corner4</td>
</tr>
<tr class="odd">
<td align="left">/perimeter/mudmap_photo</td>
<td align="left">mudmap_photo</td>
<td align="left">binary</td>
<td align="left">TRUE</td>
<td align="left">NA</td>
<td align="left">perimeter_mudmap_photo</td>
</tr>
<tr class="even">
<td align="left">/taxon_encounter</td>
<td align="left">taxon_encounter</td>
<td align="left">repeat</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">taxon_encounter</td>
</tr>
<tr class="odd">
<td align="left">/taxon_encounter/field_name</td>
<td align="left">field_name</td>
<td align="left">string</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">taxon_encounter_field_name</td>
</tr>
<tr class="even">
<td align="left">/taxon_encounter/photo_in_situ</td>
<td align="left">photo_in_situ</td>
<td align="left">binary</td>
<td align="left">TRUE</td>
<td align="left">NA</td>
<td align="left">taxon_encounter_photo_in_situ</td>
</tr>
<tr class="odd">
<td align="left">/taxon_encounter/taxon_encounter_location</td>
<td align="left">taxon_encounter_location</td>
<td align="left">geopoint</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">taxon_encounter_taxon_encounter_location</td>
</tr>
<tr class="even">
<td align="left">/taxon_encounter/life_form</td>
<td align="left">life_form</td>
<td align="left">select1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">taxon_encounter_life_form</td>
</tr>
<tr class="odd">
<td align="left">/taxon_encounter/voucher_specimen_barcode</td>
<td align="left">voucher_specimen_barcode</td>
<td align="left">barcode</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">taxon_encounter_voucher_specimen_barcode</td>
</tr>
<tr class="even">
<td align="left">/taxon_encounter/voucher_specimen_label</td>
<td align="left">voucher_specimen_label</td>
<td align="left">string</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">taxon_encounter_voucher_specimen_label</td>
</tr>
<tr class="odd">
<td align="left">/encounter_end_datetime</td>
<td align="left">encounter_end_datetime</td>
<td align="left">dateTime</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">encounter_end_datetime</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="show-details-of-one-form">Show details of one form<a class="anchor" aria-label="anchor" href="#show-details-of-one-form"></a>
</h3>
<p>The details of a form are exactly the same as the output of <code><a href="../reference/form_list.html">ruODK::form_list()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_form_detail</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/form_detail.html">form_detail</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_form_detail</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="8%">
<col width="7%">
<col width="3%">
<col width="2%">
<col width="5%">
<col width="11%">
<col width="6%">
<col width="6%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">fid</th>
<th align="left">version</th>
<th align="left">state</th>
<th align="right">submissions</th>
<th align="left">created_at</th>
<th align="right">created_by_id</th>
<th align="left">created_by</th>
<th align="left">updated_at</th>
<th align="left">published_at</th>
<th align="left">last_submission</th>
<th align="left">hash</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Flora Quadrat 0.4</td>
<td align="left">Flora-Quadrat-04</td>
<td align="left"></td>
<td align="left">open</td>
<td align="right">1</td>
<td align="left">2023-12-03T07:02:20.258Z</td>
<td align="right">6</td>
<td align="left">Florian Mayer</td>
<td align="left">2023-12-03T07:19:34.956Z</td>
<td align="left">2023-12-03T07:02:27.957Z</td>
<td align="left">2023-12-04T08:30:26.154Z</td>
<td align="left">434ff9e1e33fc8bb35148c0cc6979708</td>
</tr></tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="submissions">Submissions<a class="anchor" aria-label="anchor" href="#submissions"></a>
</h2>
<p>We are getting closer to the actual data! This section shows two of the options for data access: dump all submissions, or extract a subset.</p>
<div class="section level3">
<h3 id="get-all-submissions-for-one-form">Get all submissions for one form<a class="anchor" aria-label="anchor" href="#get-all-submissions-for-one-form"></a>
</h3>
<p>Smaller datasets lend themselves to be exported in one go. ODK Central offers one giant zip file containing all submissions, any repeating groups, and any attachments both on the form submission page, and as API endpoint which is provided as <code><a href="../reference/submission_export.html">ruODK::submission_export()</a></code>.</p>
<p>The default behaviour of <code><a href="../reference/submission_export.html">ruODK::submission_export()</a></code> is to write the zip file to the project root (<code><a href="https://here.r-lib.org//reference/here.html" class="external-link">here::here()</a></code>), and to overwrite existing previous downloads. See <code>?ruODK::submission_export()</code> for alternative download and retention options.</p>
<p>In the following chuck, we illustrate common tasks:</p>
<ul>
<li>Download the zip file.</li>
<li>Unpack the zip file.</li>
<li>Join repeating form group data <code>data_taxon</code> to main data <code>data_quadrat</code> to annotate <code>data_taxon</code> with data from <code>data_quadrat</code>.</li>
<li>Sanitise the column names.</li>
<li>Prepend all attachment filenames (e.g. <code>data_quadrat$location_quadrat_photo</code>, <code>data_taxon$photo_in_situ</code>) with <code>media/</code>.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Predict filenames (with knowledge of form)</span></span>
<span><span class="va">fid</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/ru_settings.html">get_test_fid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fid_csv</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">t</span>, <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{fid}.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fid_csv_veg</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">t</span>, <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{fid}-vegetation_stratum.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fid_csv_tae</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">t</span>, <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{fid}-taxon_encounter.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download the zip file</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/submission_export.html">submission_export</a></span><span class="op">(</span>local_dir <span class="op">=</span> <span class="va">t</span>, overwrite <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unpack the zip file</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">se</span>, exdir <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepend attachments with media/ to turn into relative file paths</span></span>
<span><span class="va">fq_zip_data</span> <span class="op">&lt;-</span> <span class="va">fid_csv</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span>na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"na"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># form uses "na" for NA</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">meta_instance_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/handle_ru_datetimes.html">handle_ru_datetimes</a></span><span class="op">(</span><span class="va">fq_form_schema</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/handle_ru_geopoints.html">handle_ru_geopoints</a></span><span class="op">(</span><span class="va">fq_form_schema</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/attachment_link.html">attachment_link</a></span><span class="op">(</span><span class="va">fq_form_schema</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fq_zip_strata</span> <span class="op">&lt;-</span> <span class="va">fid_csv_veg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span>na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"na"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">parent_key</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># ruODK::handle_ru_datetimes(fq_form_schema) parent_key%&gt;% # no dates</span></span>
<span>  <span class="co"># ruODK::handle_ru_geopoints(fq_form_schema) %&gt;%  # no geopoints</span></span>
<span>  <span class="co"># ruODK::ruODK::attachment_link(fq_form_schema) %&gt;% # no att.</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">fq_zip_data</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parent_key"</span> <span class="op">=</span> <span class="st">"meta_instance_id"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fq_zip_taxa</span> <span class="op">&lt;-</span> <span class="va">fid_csv_tae</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span>na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"na"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">parent_key</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># ruODK::handle_ru_datetimes(fq_form_schema) %&gt;%</span></span>
<span>  <span class="co"># ruODK::handle_ru_geopoints(fq_form_schema) %&gt;%</span></span>
<span>  <span class="co"># ruODK::ruODK::attachment_link(fq_form_schema) %&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">fq_zip_data</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parent_key"</span> <span class="op">=</span> <span class="st">"meta_instance_id"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fq_zip_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 38</span></span></span>
<span><span class="co">#&gt;   submission_date     meta_instance_id encounter_start_date…¹ reporter device_id</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2023-12-04 <span style="color: #949494;">08:30:26</span> uuid:46d3939a-8… 2023-12-04 <span style="color: #949494;">16:20:19</span>    <span style="color: #BB0000;">NA</span>       collect:…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​encounter_start_datetime</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 33 more variables: location_area_name &lt;chr&gt;, location_quadrat_photo &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   location_corner1_latitude &lt;dbl&gt;, location_corner1_longitude &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   location_corner1_altitude &lt;dbl&gt;, location_corner1_accuracy &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   habitat_morphological_type &lt;chr&gt;, habitat_morphological_type_photo &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   perimeter_corner2_latitude &lt;dbl&gt;, perimeter_corner2_longitude &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   perimeter_corner2_altitude &lt;dbl&gt;, perimeter_corner2_accuracy &lt;dbl&gt;, …</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fq_zip_strata</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 47</span></span></span>
<span><span class="co">#&gt;   nvis_level3_broad_floristic_gr…¹ max_height_m foliage_cover dominant_species_1</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> w3.0_shrub                                  1 70-30         Test species 1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> w1.1_trees_rainforest                       5 10-5          Test species 5    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​nvis_level3_broad_floristic_group</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 43 more variables: dominant_species_2 &lt;chr&gt;, dominant_species_3 &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   dominant_species_4 &lt;chr&gt;, parent_key &lt;chr&gt;, key.x &lt;chr&gt;, id.x &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   submission_date &lt;dttm&gt;, encounter_start_datetime &lt;dttm&gt;, reporter &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   device_id &lt;chr&gt;, location_area_name &lt;chr&gt;, location_quadrat_photo &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   location_corner1_latitude &lt;dbl&gt;, location_corner1_longitude &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   location_corner1_altitude &lt;dbl&gt;, location_corner1_accuracy &lt;dbl&gt;, …</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fq_zip_taxa</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 49</span></span></span>
<span><span class="co">#&gt;   field_name     photo_in_situ     taxon_encounter_loca…¹ taxon_encounter_loca…²</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Test species 1 1701678535420.jpg                  -<span style="color: #BB0000;">31.9</span>                   116.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Test species 6 1701678592627.jpg                  -<span style="color: #BB0000;">31.9</span>                   116.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated names: ¹​taxon_encounter_location_latitude,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ²​taxon_encounter_location_longitude</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 45 more variables: taxon_encounter_location_altitude &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   taxon_encounter_location_accuracy &lt;dbl&gt;, life_form &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   voucher_specimen_barcode &lt;lgl&gt;, voucher_specimen_label &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   parent_key &lt;chr&gt;, key.x &lt;chr&gt;, id.x &lt;chr&gt;, submission_date &lt;dttm&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   encounter_start_datetime &lt;dttm&gt;, reporter &lt;lgl&gt;, device_id &lt;chr&gt;, …</span></span></span>
<span><span class="co"># Further: create map with popups, see vignette "odata"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="list-submissions-for-one-form">List submissions for one form<a class="anchor" aria-label="anchor" href="#list-submissions-for-one-form"></a>
</h3>
<p>Not always is it appropriate to download all submissions and all attachments at once.</p>
<p>If forms feed into downstream data warehouses, the typical ETL workflow is to</p>
<ul>
<li>List all submissions from ODK Central</li>
<li>Select the subset of new submissions to download, e.g.
<ul>
<li>Submissions younger than the oldest submission date in the data warehouse.</li>
<li>Submissions whose <code>instance_id</code> is not already present in the data warehouse.</li>
</ul>
</li>
<li>Download only the selected submissions.</li>
<li>Download attachments of only the selected submissions.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_submission_list</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/submission_list.html">submission_list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fq_submission_list</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="3%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="7%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th align="left">instance_id</th>
<th align="right">submitter_id</th>
<th align="left">device_id</th>
<th align="left">created_at</th>
<th align="left">updated_at</th>
<th align="left">review_state</th>
<th align="left">user_agent</th>
<th align="right">submitter_id_2</th>
<th align="left">submitter_type</th>
<th align="left">submitter_display_name</th>
<th align="left">submitter_created_at</th>
<th align="left">submitter_updated_at</th>
<th align="left">submitter_deleted_at</th>
<th align="left">current_version</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">uuid:46d3939a-8bc5-4084-9154-d043bc4d3239</td>
<td align="right">12</td>
<td align="left">collect:OHnydk6INUIfDHNl</td>
<td align="left">2023-12-04 16:30:26</td>
<td align="left">2024-03-05 13:29:54</td>
<td align="left">approved</td>
<td align="left">org.odk.collect.android/v2023.3.1 Dalvik/2.1.0 (Linux; U; Android 10; vivo 1937 Build/QP1A.190711.020)</td>
<td align="right">12</td>
<td align="left">field_key</td>
<td align="left">ruodk</td>
<td align="left">2023-08-09 11:51:12</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">12 , 2023-12-04T08:30:26.154Z , uuid:46d3939a-8bc5-4084-9154-d043bc4d3239 , TRUE , collect:OHnydk6INUIfDHNl , org.odk.collect.android/v2023.3.1 Dalvik/2.1.0 (Linux; U; Android 10; vivo 1937 Build/QP1A.190711.020), 12 , field_key , ruodk , 2023-08-09T03:51:12.864Z</td>
</tr></tbody>
</table>
<p>The list of submissions critically contains each submission’s unique ID in <code>instance_id</code>. If the submissions shall be downloaded and uploaded into another data warehouse, the <code>instance_id</code> can be used to determine whether a record already exists in the downstream warehouse or not. This workflow is preferable where the majority of submissions is already imported into another downstream data warehouse, and we only want to add new submissions, as in submissions which are not already imported into the data warehouse.</p>
<p>Furthermore, the <code>instance_id</code>s can now be used to retrieve the actual submissions.</p>
</div>
<div class="section level3">
<h3 id="get-submission-data">Get submission data<a class="anchor" aria-label="anchor" href="#get-submission-data"></a>
</h3>
<p>In order to import each submission, we need to retrieve the data by <code>instance_id</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># One submission</span></span>
<span><span class="va">fq_one_submission</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/get_one_submission.html">get_one_submission</a></span><span class="op">(</span><span class="va">fq_submission_list</span><span class="op">$</span><span class="va">instance_id</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multiple submissions</span></span>
<span><span class="va">fq_submissions</span> <span class="op">&lt;-</span> <span class="fu">ruODK</span><span class="fu">::</span><span class="fu"><a href="../reference/submission_get.html">submission_get</a></span><span class="op">(</span><span class="va">fq_submission_list</span><span class="op">$</span><span class="va">instance_id</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parse-submissions">Parse submissions<a class="anchor" aria-label="anchor" href="#parse-submissions"></a>
</h3>
<p>The data in <code>sub</code> is one row of the bulk downloaded submissions in <code>data_quadrat</code>. The data in <code>submissions</code> represents all (or let’s pretend, the selected) submissions in <code>data_quadrat</code>. The field <code>xml</code> contains the actual submission data including repeating groups.</p>
<p>The structure is different to the output of <code><a href="../reference/odata_submission_get.html">ruODK::odata_submission_get</a></code>, therefore <code><a href="../reference/odata_submission_rectangle.html">ruODK::odata_submission_rectangle</a></code> does not work for those, as here we might have repeating groups included in a submission.</p>
<p>This structure could be used for upload into data warehouses accepting nested data as e.g. JSON.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"listviewer"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">listviewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/listviewer/man/jsonedit.html" class="external-link">jsonedit</a></span><span class="op">(</span><span class="va">fq_submissions</span>, mode <span class="op">=</span> <span class="st">"code"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ru_msg_info.html">ru_msg_info</a></span><span class="op">(</span><span class="st">"Please install package listviewer!"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="jsonedit html-widget html-fill-item" id="htmlwidget-9fdbf5b6f5a9f3e1ad36" style="width:672px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-9fdbf5b6f5a9f3e1ad36">{"x":{"data":[{"meta":{"instanceID":["uuid:46d3939a-8bc5-4084-9154-d043bc4d3239"]},"encounter_start_datetime":["2023-12-04T16:20:19.980+08:00"],"reporter":[],"device_id":["collect:OHnydk6INUIfDHNl"],"location":{"area_name":["\nTest 1"],"quadrat_photo":["1701678074209.jpg"],"corner1":["-31.895004 115.7747006 6.900000095367432 4.459"]},"habitat":{"morphological_type":["flat"],"morphological_type_photo":["1701678107041.jpg"]},"vegetation_stratum":{"nvis_level3_broad_floristic_group":["w3.0_shrub"],"max_height_m":["1.0"],"foliage_cover":["70-30"],"dominant_species_1":["Test species 1"],"dominant_species_2":["Test species 2"],"dominant_species_3":["Test species 3"],"dominant_species_4":["Test species 4"]},"vegetation_stratum.1":{"nvis_level3_broad_floristic_group":["w1.1_trees_rainforest"],"max_height_m":["5.0"],"foliage_cover":["10-5"],"dominant_species_1":["Test species 5"],"dominant_species_2":["Test species 6"],"dominant_species_3":[],"dominant_species_4":[]},"perimeter":{"corner2":["-31.8949539 115.7746704 6.900000095367432 4.765"],"corner3":["-31.8950485 115.7747255 7.200000286102295 4.47"],"corner4":["-31.895046 115.7747159 6.900000095367432 16.152"],"mudmap_photo":["1701678512568.jpg"]},"taxon_encounter":{"field_name":["Test species 1"],"photo_in_situ":["1701678535420.jpg"],"taxon_encounter_location":["-31.8950488 115.7746951 6.900000095367432 4.649"],"life_form":["w3.0_shrub"],"voucher_specimen_barcode":[],"voucher_specimen_label":["12345"]},"taxon_encounter.1":{"field_name":["Test species 6"],"photo_in_situ":["1701678592627.jpg"],"taxon_encounter_location":["-31.8950303 115.7746873 6.900000095367432 5.908"],"life_form":["w1.0_trees_with_dominant_genus"],"voucher_specimen_barcode":[],"voucher_specimen_label":["1234567"]},"encounter_end_datetime":["2023-12-04T16:30:21.340+08:00"]}],"options":{"mode":"code","modes":["text","tree","table"]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level2">
<h2 id="outlook">Outlook<a class="anchor" aria-label="anchor" href="#outlook"></a>
</h2>
<p>The approach shown here yields nested and stand-alone records, which is useful if the subsequent use requires records in nested JSON or XML format. Complex forms with repeating sub-groups will result in highly nested lists, whose structure heavily depends on the completeness of the submissions.</p>
<p>The other approach shown in <a href="https://docs.ropensci.org/ruODK/articles/odata-api.html"><code>vignette("odata-api", package="ruODK")</code></a> yields rectangled data in several normalised tables, which is useful for analysis and visualisation.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
